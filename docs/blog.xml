<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Brian O&#39;Meara</title>
<link>https://brianomeara.info/blog.html</link>
<atom:link href="https://brianomeara.info/blog.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.2.475</generator>
<lastBuildDate>Sun, 23 Apr 2023 04:00:00 GMT</lastBuildDate>
<item>
  <title>An alternative to CRAN for phylogenetics</title>
  <dc:creator>Brian O&#39;Meara</dc:creator>
  <link>https://brianomeara.info/posts/phylotasticruniverse/index.html</link>
  <description><![CDATA[ 




<p>For installing R packages, <a href="https://cran.r-project.org/">CRAN</a> is the main place to go. It’s a fantastic free service that checks R packages to make sure they meet standards and then compiles them for multiple architectures. It’s largely a <a href="https://cran.r-project.org/CRAN_team.htm">volunteer effort</a> and is important to keep packages working together. <a href="https://www.bioconductor.org/">Bioconductor</a> is a more specialized repository. Getting a package to pass the checks to go on CRAN has long been a point of pride, and it does lead to higher quality packages, though with odd constraints (the overall package size must be small, all examples must run very quickly, and more).</p>
<p>However, <em>keeping</em> a package on CRAN is an issue. Requirements keep changing: will this package work on the development version of R on Debian with a clang compiler, Fedora with a gcc compiler, Mac with both arm and x86 chips, Windows, etc. and continue to do so as operating systems, hardware, and compilers change? For example, our <a href="https://cran.r-project.org/web/checks/check_results_hisse.html"><em>hisse</em></a> package was removed briefly from CRAN in spring 2023 (it’s back online) because of an issue where, while the package passed all checks for Mac, Windows, Linux, all R-devel, R-patched, R-release, and R-oldrel, it would generate a warning if compiled using the <code>-Wlto-type-mismatch</code> flag to GCC. Our code hadn’t changed, and this wouldn’t have affected any users, but CRAN gave us two weeks to fix the warning. We didn’t do it on time, so it was archived, which <em>does</em> affect users (making it impossible for most users on Mac or Windows to use it, for example, as they don’t have compilers installed).</p>
<p>If you are part of an ecosystem, there are further risks. Many phylogenetics packages depend or import <a href="https://cran.r-project.org/web/packages/geiger/index.html"><code>geiger</code></a> – CRAN removed that package, and then two weeks later would have also archived every package that depends on it. Geiger’s authors got it restored in time, but it shows how brittle CRAN’s policies make our community. It’s like the <a href="https://xkcd.com/2347/">Randall Munroe XKCD cartoon</a>:</p>
<p><img src="https://brianomeara.info/posts/phylotasticruniverse/https:/imgs.xkcd.com/comics/dependency_2x.png" class="img-fluid" alt="XKCD cartoon showing a stack of boxes labeled 'All modern digital infrastructure' carefullly balancing on a small box labeled 'A project some random person in Nebraska has been thanklessly maintaining since 2003'"></p>
<p>but with the poor maintainer in Nebraska putting the whole ecosystem at risk if they take two weeks off and there is a new requirement in the interim.</p>
<p>The nature of academia makes this even more precarious. A student might work on a package for their dissertation and others could find it very useful. There is no guarantee that the student remains in the field: it’s not unusual for someone to go into teaching, or working at a nonprofit, or working for a company, and even the weak incentive of getting more citations is no longer sufficiently relevant for them to volunteer their time to meet changing CRAN standards. Ongoing maintenance would be ideal for the field, but it is a high bar.</p>
<p>Fortunately, rOpenSci has made an alternative: <a href="https://ropensci.org/r-universe/">r-universe</a>. This creates a place where R packages can be built automatically for different platforms, just as CRAN does, but in nearly real time. If a package is in an open source repository (the best known is GitHub), and the r-universe instance knows about it, it will try to compile it. Thus, even if something goes off CRAN, students taking a class can likely still install it from r-universe.</p>
<p>To help our community, I’ve created an instance for phylogenetics. The instance is at https://phylotastic.r-universe.dev/ . Information on how to use it is at http://phylotastic.org/phylotastic.r-universe.dev/. For the packages, I’ve used everything from the <a href="https://cran.r-project.org/web/views/Phylogenetics.html">CRAN task view for phylogenetics</a> (something I maintained for over a decade, now taken over by <a href="https://williamgearty.com/">Dr.&nbsp;William Gearty</a> who has assembled a team to keep it going), as well as other packages used in phylogenetics in R, including packages in development.</p>
<section id="using-the-universe" class="level3">
<h3 class="anchored" data-anchor-id="using-the-universe">Using the universe</h3>
<p>To use the most recent available version of each package:</p>
<pre><code>options(repos = c(
  phylotastic = 'https://phylotastic.r-universe.dev',
  CRAN = 'https://cloud.r-project.org')
 )</code></pre>
<p>This will check the phylotastic r-universe, and only go to CRAN for packages that are not there.</p>
<p>To use the CRAN package if available, then use phylotastic as a backup:</p>
<pre><code>options(repos = c(
  CRAN = 'https://cloud.r-project.org',
  phylotastic = 'https://phylotastic.r-universe.dev')
 )</code></pre>
</section>
<section id="why-phylotastic" class="level3">
<h3 class="anchored" data-anchor-id="why-phylotastic">Why “phylotastic”?</h3>
<p>Phylotastic started as an idea launched at the [US] National Evolutionary Synthesis Center, NESCent, in 2012. Over hackathons and other events, and later an NSF grant (written by Arlin Stoltzfus, Enrico Pontelli, and me) it resulted in various tools for phylogenetics (includng http://datelife.opentreeoflife.org/ ). I wanted to keep that connection, not least so that people could use phylotastic R packages even when there are CRAN hiccups.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{o'meara2023,
  author = {Brian O’Meara},
  title = {An Alternative to {CRAN} for Phylogenetics},
  date = {2023-04-23},
  url = {https://brianomeara.info/posts/phylotasticruniverse},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-o'meara2023" class="csl-entry quarto-appendix-citeas">
Brian O’Meara. 2023. <span>“An Alternative to CRAN for
Phylogenetics.”</span> April 23, 2023. <a href="https://brianomeara.info/posts/phylotasticruniverse">https://brianomeara.info/posts/phylotasticruniverse</a>.
</div></div></section></div> ]]></description>
  <category>R</category>
  <category>rbloggers</category>
  <category>reproducibility</category>
  <guid>https://brianomeara.info/posts/phylotasticruniverse/index.html</guid>
  <pubDate>Sun, 23 Apr 2023 04:00:00 GMT</pubDate>
  <media:content url="https://imgs.xkcd.com/comics/dependency_2x.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Fossils do not help fix diversification parameter estimates</title>
  <dc:creator>Brian O&#39;Meara</dc:creator>
  <link>https://brianomeara.info/posts/fossilsdonothelp/index.html</link>
  <description><![CDATA[ 




<p>Jeremy Beaulieu and I have a <a href="https://doi.org/10.1093/sysbio/syac049">paper</a> in <em>Systematic Biology</em> on the impact of fossils on estimating diversification rates. There has been a lot of interest in the fossilized birth-death process, FBD (<a href="https://doi-org.utk.idm.oclc.org/10.1016/j.jtbi.2010.09.010">Stadler 2010</a>), and with the rediscovery in the field that diversification methods might be telling tales signifying nothing, Jeremy and I thought about how the FBD might help. We know fossils help, a lot, with things like ancestral state reconstruction and dating trees: knowing about fossils might help with diversification processes (especially with parameters relating to extinction).</p>
<p>Jeremy implemented it in <a href="https://speciationextinction.info/"><em>hisse</em></a>. One thing we discussed in the implementation is how there are two kinds of fossils FBD uses:</p>
<p><img src="https://brianomeara.info/posts/fossilsdonothelp/fbd_fig1.png" class="img-fluid" alt="Figure 1 from Beaulieu and O'Meara (2022), showing the distribution of fossils on two trees. The left tree shows the sampled fossils; the right plot shows the distinction between parent fossils (ones that have a descendant sample, either a fossil or a tip) and childless fossils (terminal fossils)."></p>
<p>One is terminals that are fossils with no sampled descendants (‘<em>m</em>’ type). The other is parent fossils (‘<em>k</em>’ type): they have a sampled descendant on the tree (which could be a fossil or extant tip). We worried that the methods assume equal probability of sampling for all these fossils, but that empiricists might not be generating data that meet these assumptions. For example, one might put a single <em>T. rex</em> fossil specimen on the tree, but would one put on every individual? All but the most recent one would be parent fossils, and we suspected they could be missing.</p>
<p>We made predictions based on the math, but it’s also useful to test with simulations. Simulations can be tricky when testing models: all models are simplifications of the world that can fail if the world is complex in the wrong ways. One can always write “method X fails under real world conditions Y” if conditions are extreme enough, but that doesn’t necessarily mean that it will fail in everyday use. So in setting up our simulations for this study, we chose to make it biased towards FBD working and based on realistic parameters. One way we biased it was including mass extinctions: methods using only tip data should do terribly for that, and fossils might help.</p>
<p>The key result is in Figure 4:</p>
<p><img src="https://brianomeara.info/posts/fossilsdonothelp/fbd_fig4b.png" class="img-fluid" alt="Figure 4b from Beaulieu and O'Meara (2022), showing the estimated turnover rate with different true turnover rates and different way of running the analysis. It shows a grouping of box plots, with red lines showing the true values. Using extant data only performed far better than using extant with sampled fossil tips; using all the parent and terminal fossils performed about as well as no fossils at all."></p>
<p>Using just the extant tips (dark purple) performed better than using extant tips and fossil tips (white bars) and similarly to using all the fossils, which based on limited data (see our Figure 3) is rarely done empirically. This surprised us: we were expecting fossils to pretty clearly help except when there was a bias to only use tip fossils. It is frankly a little disappointing that even perfect fossil data (we assumed fossil positions were known exactly, for example) does not help noticeably with estimating diversification models (though they remain important for dating, for ancestral state reconstruction, and likely for tree inference, as well).</p>
<p>To see all the code we used, go to https://github.com/thej022214/Fossils_impact_BO .</p>
<p>To see how to use fossils in <em>hisse</em>, including in models with and without traits, look at Jeremy’s vignette: https://speciationextinction.info/articles/adding_fossils.html . Based on our analysis, fossils don’t help much with diversification, but you can prove us wrong for your data, and you can use these tools for things like looking at correlations where fossils might indeed help.</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{o'meara2023,
  author = {Brian O’Meara},
  title = {Fossils Do Not Help Fix Diversification Parameter Estimates},
  date = {2023-04-22},
  url = {https://brianomeara.info/posts/fossilsdonothelp},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-o'meara2023" class="csl-entry quarto-appendix-citeas">
Brian O’Meara. 2023. <span>“Fossils Do Not Help Fix Diversification
Parameter Estimates.”</span> April 22, 2023. <a href="https://brianomeara.info/posts/fossilsdonothelp">https://brianomeara.info/posts/fossilsdonothelp</a>.
</div></div></section></div> ]]></description>
  <category>fossil</category>
  <category>R</category>
  <category>hisse</category>
  <category>misse</category>
  <category>diversification</category>
  <category>simulation</category>
  <category>publication</category>
  <guid>https://brianomeara.info/posts/fossilsdonothelp/index.html</guid>
  <pubDate>Sat, 22 Apr 2023 04:00:00 GMT</pubDate>
  <media:content url="https://brianomeara.info/posts/fossilsdonothelp/fbd_fig1.png" medium="image" type="image/png" height="81" width="144"/>
</item>
</channel>
</rss>
