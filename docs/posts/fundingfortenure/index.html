<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brian O’Meara">
<meta name="dcterms.date" content="2025-05-04">
<meta name="description" content="Faculty funding should not play a role in tenure decisions, especially now">

<title>Funding for tenure – Brian O’Meara</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7ad6542725e80d1433b1f8ee26c2a1fc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Brian O’Meara</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cv-etc." role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">CV, etc.</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cv-etc.">    
        <li>
    <a class="dropdown-item" href="../../cv.html">
 <span class="dropdown-text">CV</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../calendar.html">
 <span class="dropdown-text">Calendar</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../feedback.html">
 <span class="dropdown-text">Feedback</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../useful.html">
 <span class="dropdown-text">Useful links</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tenure.html">
 <span class="dropdown-text">Materials for promotion to associate (and tenure)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../promotion.html">
 <span class="dropdown-text">Materials for promotion to full</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../SSB.html">
 <span class="dropdown-text">Candidacy for SSB president</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../evol2023.html">
 <span class="dropdown-text">SSB Presidential Address 2023</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lab" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lab</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lab">    
        <li>
    <a class="dropdown-item" href="../../personnel.html">
 <span class="dropdown-text">People</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../guidelines.html">
 <span class="dropdown-text">Guidelines &amp; Recommendations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../location.html">
 <span class="dropdown-text">Location/Contact</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../opportunities.html">
 <span class="dropdown-text">Opportunities</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../learningobjectives.html">
 <span class="dropdown-text">Learning objectives</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../better-letter.html">
 <span class="dropdown-text">BetterLetter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../shouldyougotogradschool.html">
 <span class="dropdown-text">Should you go to grad school to be a professor?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tenure.html">
 <span class="dropdown-text">Materials for promotion to associate (and tenure)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../promotion.html">
 <span class="dropdown-text">Materials for promotion to full</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../general.html">
 <span class="dropdown-text">Info for general public</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../covid.html">
 <span class="dropdown-text">COVID</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../schedule.html">
 <span class="dropdown-text">EEB scheduling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../../teaching.html">
 <span class="dropdown-text">Teaching overall</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../eeb464.html">
 <span class="dropdown-text">Macroevolution (EEB464)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://phylometh.info/">
 <span class="dropdown-text">Phylogenetic Methods</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../../aic.html">
 <span class="dropdown-text">AIC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../phylogenetics.html">
 <span class="dropdown-text">Phylogenetics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-blog">    
        <li>
    <a class="dropdown-item" href="../../blog.html">
 <span class="dropdown-text">Blog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../blog.xml">
 <span class="dropdown-text">RSS feed</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Funding for tenure</h1>
                  <div>
        <div class="description">
          Faculty funding should not play a role in tenure decisions, especially now
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">NSF</div>
                <div class="quarto-category">NIH</div>
                <div class="quarto-category">tenure</div>
                <div class="quarto-category">funding</div>
                <div class="quarto-category">indirect costs</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Brian O’Meara </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 4, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-about-indirect-costs-startup-etc." id="toc-what-about-indirect-costs-startup-etc." class="nav-link active" data-scroll-target="#what-about-indirect-costs-startup-etc.">What about indirect costs, startup, etc.?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>In the US, science funding is being cut, including the elimination of entire areas of study from federal funding. There are predictions of yet more reductions. This will affect what will be studied, who can study it, and even who survive diseases. Various individuals and groups are working to address this. I want to address just one small part of this where faculty still have (some) control: criteria we use in awarding tenure.</p>
<p>The standards for tenure can be opaque to various degrees: we all do teaching, research, and service, and institutions vary in how they weight each of these within the institution and across faculty members. Institutions vary in what constitutes evidence for each. For example, one person might teach a large number of intro classes and have peer evaluation of their teaching, while at a different institution someone may teach a few small enrollment classes and be evaluated on how well they are mentoring grad students. The AAUP has a <a href="https://www.aaup.org/report/2022-aaup-survey-tenure-practices">survey</a> of tenure practices, a quarter-century old <a href="https://www.aaup.org/sites/default/files/files/Good%20Practice%20in%20Tenure%20Evaluation.pdf">book</a> about best practices (probably due for some updating), and a <a href="https://www.aaup.org/issues/tenure/resources-tenure">page</a> aggregating additional resources for those seeking to learn more.</p>
<p>But imagine if a department had a standard for tenure of using 10,000 pipette tips. Each time you finish a box of tips, you put an empty box against the wall: only 105 boxes total to get to tenure! Of course, this doesn’t work for people doing bird banding, or theoretical ecology, or any of a myriad of research programs. Pipette tips are a tool, not a goal. Within a narrow area they might be an okay proxy for productivity: back when I was <a href="https://www.ncbi.nlm.nih.gov/nuccore/?term=brian+o%27meara">sequencing ant DNA</a> my pipette box accumulation rate could have been a good way to spot check how much time I was spending in the ant lab. But it would have been a terrible way to measure how much work I was spending coding new methods or writing papers. And using tips as a criterion could warp the research program: instead of banding birds, someone might have to change the research to do blood draws on captured birds to have a wet lab component, just in order to use enough tips to get tenure.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="emptyboxes.jpg" class="img-fluid figure-img" alt="Stack of about forty empty pipette boxes: navy blue boxes, most for 200 µl pipette tips, with opaque white covers, in a wood cabinet."></p>
<figcaption>Enough boxes to be 38% of the way to tenure? Photo from <a href="https://www.reddit.com/r/labrats/comments/nvzy6b/what_on_earth_do_you_do_with_your_empty_tip_boxes/">reddit user strawspiderflower.</a></figcaption>
</figure>
</div>
<p>I suggest funding is the same. It is a <em>tool</em> that enables research, outreach, and more, but it <em>isn’t the goal itself</em>. It’s fantastically useful, of course. I’ve been lucky to work with 17 postdocs so far as a mentor, all of whom needed money for things like food and health care: about half the time, that came from grants I wrote, with the rest of the time coming from grants written by others (thanks, NSF, and the UTK team who wrote the <a href="https://legacy.nimbios.org/about/impact">NIMBioS (National Institute for Mathematical and Biological Synthesis)</a> grant!). Other people need funding to pay for sequencing, or to fly to Costa Rica to collect insects, or to get a LI-COR to measure leaf respiration. And different research requires different amounts of funding – someone collecting fossils in the Arctic is not a better scientist than someone collecting fossils ten miles away from campus, but the former requires more money (and is generally less accessible to students). If both scientists are publishing good work at the same rate, why do we care that one person had to rent a helicopter and another a bicycle? It gets even more stark between fields: someone doing mathematical models may need far less funding than someone working on cancer research in a general biology department, and they also have access to different funding sources (at least historically, NIH provided more money than NSF), but the department is better for having both of them in the same place.</p>
<p>This is a time when there is even less reason to judge people by their funding. Federal funders and others have been cutting off funding for entire subfields. Faculty are pivoting their science to be able to keep doing work that matters. We want to encourage this: let them grow their research program and adapt to the changing world (this does not mean not trying to make improvements, but it does recognize external constraints). Having a performance standard that is based on the quality of science they are communicating makes sense. Adding a second metric, funding, warps that. In evolutionary biology, we teach about tradeoffs: armor is great, so is flight, but we don’t have flying armored turtles. Funding can serve the science, but making it a criterion in itself creates potential tradeoffs between the best science to do and the best science to get funding.</p>
<p><strong>Suggested action item</strong>: Departments should have conversations about criteria for tenure, and explictly discuss, and put in writing, that funding is NOT one of those criteria. Ideally, this should be put into departmental bylaws. The end of the semester is a hard time for this, but faculty are going to be trying to figure out what to do this summer: giving them reassurance about optimizing just for good science will let them focus on this. For some, this will require figuring out funding, but not for all. When people come back together in the Fall, bylaws that mention funding should be amended, as well as similar work at higher levels of an institution. There might be work that correlates with funding (Has a faculty member been able to recruit and mentor grad students? Have they been able to develop modern, publishable datasets?) but <em>the work</em> is what we care about, not the funding itself.</p>
<section id="what-about-indirect-costs-startup-etc." class="level3">
<h3 class="anchored" data-anchor-id="what-about-indirect-costs-startup-etc.">What about indirect costs, startup, etc.?</h3>
<p>An objection to ignoring funding as a criterion for tenure is that grants are ways to support other aspects of the university. It is worth digging into the details of this, though.</p>
<p>First, though it’s an imperfect analogy, it can be worth comparing a new lab to a new coffee shop. To start up a coffee shop, one needs to get a building, equipment, and supplies: everything from flour to make the donuts to a soap dispenser in the bathroom to cups for the coffee. Then one needs to hire and train staff. Only then can one open for business and start making money. For example, for a <a href="https://finance.yahoo.com/news/much-costs-own-starbucks-franchise-180021683.html">Starbucks</a>, it costs $315,000 to license a store (which includes some equipment) and one must have $700,000 in cash for other costs. [Note I really wanted to find the similar cost for the far superior Dunkin’ Donuts instead, but it’s not available]. That’s the same order of magnitude as starting a biology lab at a research-intensive university, where startups in the hundreds of thousands of dollars are common.</p>
<p>One question any business owner has to face is how much to price each item. There’s the obvious cost of ingredients; there’s also the fractional cost of the employee that makes the coffee: a fancier coffee takes more time and so should cost more. But there are other costs that are harder to calculate. What fraction of a light bulb’s lifespan is used to illuminate the coffee station where the coffee is made? How much of the cash register’s overall cost is each cup of coffee responsible for? What about the person working the cash register? One way to do this would be to measure this exactly for everything: “hot tea” takes less time to say than “regular coffee black with two sugars” so the latter costs more of the cashier’s time. A different approach would be to figure out the obvious costs for the ingredients and direct labor, figure out all the other costs for the entire store, and find a ratio that makes it break even with a little extra for profit. For example, if a small cup of coffee costs $1.00 to make, add 50% to the cost of that to cover all the other costs and charge $1.50; maybe bump it up to $1.59 for a little profit.</p>
<p>The same applies for a lab. If one is proposing a project to sequence ant DNA to infer their phylogeny, there’s the cost to go to collect the ants in the field, the DNA extraction kits, PCR reagents, sequencing costs, and more. There’s the cost for the grad student to do the work (stipend, health care, and tuition). These are all calculated ahead of time and charged to the funder. But there are also all the other costs: someone to make sure the lab is run safely, having a building to do the work in, paying to run the -80 ˚C freezer, and more. Rather than figuring out these costs per project, the institution where the work happens negotiates with the federal government about the average overall costs. At a university, every $100 of direct cost might mean $50-60 in indirect costs, so that can be the negotiated rate. For institutions like children’s hospitals, it can be even higher, like <a href="https://www.childrenshospital.org/sites/default/files/2024-09/BCH%20RATE%20AGREEMENT_03.18.24.pdf">78%</a> at Children’s Hospital Boston.</p>
<p>The thing is, the folk wisdom about this (backed by research: <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC3987954/">Holbrook and Sanberg (2013)</a>) is that universities lose money on this. The indirect costs do not quite cover the cost of the research. In some ways, this is like athletics programs: they only <a href="https://sportsdata.usatoday.com/ncaa/finances">rarely</a> make money, but they help with brand recognition, student spirit, and more. Research is even more central to the mission of a university – universities are about generating new knowledge and sharing it, and funded research is a major part of this. Overall amount of research expenditure is also a metric used in rating or categorizing universities – it looks “good” by metrics some care about to have a lot of research expenditure.</p>
<p>Moreover, just in terms of earnings per square foot, research labs are a spectacularly bad way to make money. Take the University of Florida, a major research university. As of the latest data (2023), it had <a href="https://ncses.nsf.gov/surveys/science-engineering-research-facilities/2023#survey-info">3,884,000 square feet</a> for research and engineering; it also spent (from external funds) <a href="https://ncsesdata.nsf.gov/profiles/site?method=rankingbysource&amp;ds=herd">$1,250,201,000</a>, for an average of $322 per square foot. A Starbucks has sales of $700/sqft, McDonald’s $2196/sqft, an Apple store $25,000/sqft, and even Walmart is $407/sqft (from <a href="https://www.analystinterview.com/article/understanding-sales-per-square-foot-a-key-metric-in-retail-food-and-beverages">here</a>, which is not peer-reviewed). And consider the cost to run a Walmart compared to a bunch of labs with the same total amount of square footage: Walmart has no fume hoods, no centrifuges, few expensive freezers, minimal computers, etc. and yet it only makes about 3% profit on this earnings per square foot. Walmart’s earnings for this space are 25% higher than what U. of Florida brings in with grants – it is hard to imagine U. of Florida is breaking even at this rate (and that is before proposed cuts in indirect rates). But the university is fostering <a href="https://explore.research.ufl.edu">great research</a> that has both immediate impacts (<a href="https://news.ufl.edu/2025/01/citrus-greening-research/">helping citrus growers</a>) and long-term discoveries (<a href="https://explore.research.ufl.edu/secrets-of-the-sea.html">detecting wildlife with wisps of DNA in the ocean</a>) while also training students and postdocs as part of its educational mission. And this sort of contribution is common for the thousands of universities across the US.</p>
<p>So, TL;DR: any university is likely losing money on research in general; given the high variance in how much funding different research groups bring in, it is likely that nearly all individual labs are overall subsidized by the university (the “Use AI to find people who are bad credit risks” or the “Patent a banana that stays yellow for months” labs might be exceptions). Many people, even from “successful” labs (based on grants), are not bringing in enough funding to break even, but they are worth the investment due to their discoveries. Our institutions at a high level realize that the research is what matters and focus on that. For those of us who are even closer to the research, in the same departments as those doing the work, we should similarly value the quality of the work, not the money or other tools used to help achieve it. We must put in structural changes to reassure our junior colleagues that we will evaluate their work, not their funding, especially now.</p>
<hr>
<p>To subscribe, go to <a href="https://brianomeara.info/blog.xml" class="uri">https://brianomeara.info/blog.xml</a> in an RSS reader.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{o'meara2025,
  author = {O’Meara, Brian},
  title = {Funding for Tenure},
  date = {2025-05-04},
  url = {https://brianomeara.info/posts/fundingfortenure/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-o'meara2025" class="csl-entry quarto-appendix-citeas" role="listitem">
O’Meara, Brian. 2025. <span>“Funding for Tenure.”</span> May 4, 2025. <a href="https://brianomeara.info/posts/fundingfortenure/">https://brianomeara.info/posts/fundingfortenure/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/brianomeara\.info");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>